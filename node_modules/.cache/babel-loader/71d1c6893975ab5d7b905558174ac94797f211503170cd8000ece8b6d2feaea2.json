{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import axios from\"axios\";import dayjs from\"dayjs\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const[items,setItems]=useState([]);const[user,setUser]=useState(null);// Получение данных пользователя и созданных им элементов\nuseEffect(()=>{const fetchData=async()=>{try{const username=localStorage.getItem(\"username\");setUser(username);const response=await axios.get(\"http://localhost:5000/api/data\");const userItems=response.data.filter(item=>item.user===username);setItems(userItems);}catch(error){console.error(\"Ошибка при загрузке данных:\",error);}};fetchData();},[]);if(!user){return/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});}// Вычисляем текущий и предыдущий месяц\nconst currentMonth=dayjs().month();// Текущий месяц\nconst previousMonth=dayjs().subtract(1,\"month\").month();// Предыдущий месяц\n// Фильтруем заявки за текущий и предыдущий месяцы\nconst currentMonthItems=items.filter(item=>dayjs(item.createdAt).month()===currentMonth);const previousMonthItems=items.filter(item=>dayjs(item.createdAt).month()===previousMonth);// Вычисляем сумму всех значений price и calcPay\nconst totalPrice=items.reduce((total,item)=>{const price=parseFloat(item.price)||0;return total+price;},0);const totalCalcPay=items.reduce((total,item)=>{const calcPay=parseFloat(item.calcPay)||0;return total+calcPay;},0);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Go to Home\"})}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F: \",user]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432: \",items.length]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041E\\u0431\\u0449\\u0435\\u0435 \\u043A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0441\\u0443\\u043C\\u043C \\u0437\\u0430\\u043A\\u0430\\u0437\\u043E\\u0432: \",totalPrice]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041E\\u0431\\u0449\\u0435\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435 calcPay: \",totalCalcPay]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u0437\\u0430 \\u0442\\u0435\\u043A\\u0443\\u0449\\u0438\\u0439 \\u043C\\u0435\\u0441\\u044F\\u0446: \",currentMonthItems.length]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u0437\\u0430 \\u043F\\u0440\\u0435\\u0434\\u044B\\u0434\\u0443\\u0449\\u0438\\u0439 \\u043C\\u0435\\u0441\\u044F\\u0446: \",previousMonthItems.length]})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","Link","axios","dayjs","jsx","_jsx","jsxs","_jsxs","Profile","items","setItems","user","setUser","fetchData","username","localStorage","getItem","response","get","userItems","data","filter","item","error","console","children","currentMonth","month","previousMonth","subtract","currentMonthItems","createdAt","previousMonthItems","totalPrice","reduce","total","price","parseFloat","totalCalcPay","calcPay","to","length"],"sources":["C:/Users/USER/Downloads/BamSheet/my-spreadsheet-app/bamapp/src/components/Profile.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst Profile = () => {\r\n  const [items, setItems] = useState([]);\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Получение данных пользователя и созданных им элементов\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const username = localStorage.getItem(\"username\");\r\n        setUser(username);\r\n\r\n        const response = await axios.get(\"http://localhost:5000/api/data\");\r\n        const userItems = response.data.filter(\r\n          (item) => item.user === username\r\n        );\r\n        setItems(userItems);\r\n      } catch (error) {\r\n        console.error(\"Ошибка при загрузке данных:\", error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  if (!user) {\r\n    return <p>Загрузка...</p>;\r\n  }\r\n\r\n  // Вычисляем текущий и предыдущий месяц\r\n  const currentMonth = dayjs().month(); // Текущий месяц\r\n  const previousMonth = dayjs().subtract(1, \"month\").month(); // Предыдущий месяц\r\n\r\n  // Фильтруем заявки за текущий и предыдущий месяцы\r\n  const currentMonthItems = items.filter(\r\n    (item) => dayjs(item.createdAt).month() === currentMonth\r\n  );\r\n  const previousMonthItems = items.filter(\r\n    (item) => dayjs(item.createdAt).month() === previousMonth\r\n  );\r\n\r\n  // Вычисляем сумму всех значений price и calcPay\r\n  const totalPrice = items.reduce((total, item) => {\r\n    const price = parseFloat(item.price) || 0;\r\n    return total + price;\r\n  }, 0);\r\n\r\n  const totalCalcPay = items.reduce((total, item) => {\r\n    const calcPay = parseFloat(item.calcPay) || 0;\r\n    return total + calcPay;\r\n  }, 0);\r\n\r\n  return (\r\n    <div>\r\n      <Link to=\"/\">\r\n        <button>Go to Home</button>\r\n      </Link>\r\n      <h1>Профиль пользователя: {user}</h1>\r\n      <p>Количество созданных элементов: {items.length}</p>\r\n      <p>Общее количество сумм заказов: {totalPrice}</p>\r\n      <p>Общее значение calcPay: {totalCalcPay}</p>\r\n      <p>Количество заявок за текущий месяц: {currentMonthItems.length}</p>\r\n      <p>Количество заявок за предыдущий месяц: {previousMonthItems.length}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}